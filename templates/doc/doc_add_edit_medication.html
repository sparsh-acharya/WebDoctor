{% extends "doc_base.html" %}

{% block content %}
<main class="flex-1 container mx-auto px-4 py-6">
    <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-6 max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold text-gray-900 mb-6">{{action}} Medication for {{ medication.patient.full_name }}</h1>

        <form method="post" class="space-y-6">
            {% csrf_token %}

            <div>
                <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-700">Medication Name</label>
                <input type="text" name="name" value="{{ form.name.value|default_if_none:'' }}" id="{{ form.name.id_for_label }}"
                       class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="{{ form.dosage.id_for_label }}" class="block text-sm font-medium text-gray-700">Dosage (mg)</label>
                    <input type="number" name="dosage" value="{{ form.dosage.value|default_if_none:'' }}" id="{{ form.dosage.id_for_label }}"
                           class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                </div>
                <div>
                    <label for="{{ form.frequency.id_for_label }}" class="block text-sm font-medium text-gray-700">Frequency</label>
                    <input type="text" name="frequency" value="{{ form.frequency.value|default_if_none:'' }}" id="{{ form.frequency.id_for_label }}"
                           class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="{{ form.start_date.id_for_label }}" class="block text-sm font-medium text-gray-700">Start Date</label>
                    <input type="date" name="start_date" value="{{ form.start_date.value|date:'Y-m-d' }}" id="{{ form.start_date.id_for_label }}"
                           class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                </div>
                <div>
                    <label for="{{ form.duration.id_for_label }}" class="block text-sm font-medium text-gray-700">Duration (days)</label>
                    <input type="number" name="duration" value="{{ form.duration.value|default_if_none:'' }}" id="{{ form.duration.id_for_label }}"
                           class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                </div>
            </div>

            <div>
                <label for="{{ form.status.id_for_label }}" class="block text-sm font-medium text-gray-700">Status</label>
                <select name="status" id="{{ form.status.id_for_label }}"
                        class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    {% for value, text in form.status.field.choices %}
                        <option value="{{ value }}" {% if form.status.value == value %}selected{% endif %}>{{ text }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="flex justify-end space-x-4 pt-4">
                {% if action == 'Edit' %}
                <a href="{% url 'DOC_PAT_DETAIL' medication.patient.id %}" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition duration-150 ease-in-out">Cancel</a>
                {% else %}
                <a href="{% url 'DOC_PAT_DETAIL' id %}" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition duration-150 ease-in-out">Cancel</a>
                {% endif %}
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">Save Changes</button>
            </div>
        </form>
    </div>
</main>
{% endblock %}
